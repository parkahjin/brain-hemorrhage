인사말


-------------------------------
뇌출혈은 발병 후 초기 치료 시점에 따라 환자의 생존율과 후유증 정도가 크게 달라지는 응급 질환입니다. 
그러나 응급 상황에서는 
전문 의료진이 항시 CT나 MRI 영상을 판독하기 어렵고, 
진단이 늦어지면 사망률이 높아지고 장기적인 신체·인지 장애로 이어질 가능성이 큽니다. 
또한 일부 의료 기관에서는 전문 영상을 판독할 인력이 부족하거나, 
원격 지역에서는 신속한 의료 지원이 어렵다는 문제도 존재합니다. 
이러한 문제를 해결하기 위해, 
우리는 AI 기반 뇌출혈 조기 진단 시스템을 개발하여 의료진이 보다 빠르고 정확하게 환자를 평가하고, 
조기 치료를 결정할 수 있도록 돕고자 프로젝트를 시작했습니다.

------------------------------------------------------
<코드 구현을 시작하겠습니다>

우선 파이썬 파일을 만들어주겠습니다. (brain_ct_improved.py)

해당 프로젝트에 필요한 라이브러리를 입력해주고,

탭에 표시될 부분을 설정하는 코드를 입력해 줍니다.

다음으로 커스텀한 CSS 코드를 입력해주고,

헤더부분으로 나올 글자를 입력해줍니다.

그리고 사이드바 부분으로 이미지를 업로드하는 박스와, 모델을 선택하는 박스, 고급옵션, 사용 정보 등을 구현하는 코드를
입력해줍니다.

다음으로, h5 파일 형식으로 저장한 전에 개발했던 모델을 로드해주는 코드를 입력합니다.

다음으로, 메인 화면에 안내 메세지를 표시하는 코드를 입력하고, 이미지를 예측하는 과정이 들어있는 코드를 입력해줍니다.

그리고 예측 결과를 표시하는 코드를 입력해줍니다.

다음으로 이미지 및 Grad-CAM을 표시하는 코드를 입력합니다.
이 부분에서 뇌출혈로 판단할 때는 원본 이미지, 히트맵, 오버레이 이미지가 나오게 하고, 정상으로 판단할 경우,
원본 이미지만 나타나도록 코드를 구현한 것을 확인할 수 있습니다.

그 다음, 설명텍스트로 결과 텍스트와 의료 면책 조항 정보를 입력해 줍니다.

마지막으로 푸터 부분을 입력해주면 Streamlit 코드가 완성이 됩니다.

그럼 작성한 코드를 실행해 보겠습니다.

------------------------------------------------------
<구현된 화면 시연을 시작하겠습니다>
우선, 로그인 화면이 먼저 나타나고, 회원가입을 먼저 해보겠습니다.
아이디, 비밀번호, 이름, 이메일을 형식에 맞게 입력을 해주고 회원가입 버튼을 누르면 제가 입력한
데이터들이 DB에 저장이 되면서 회원가입이 되고, 로그인 페이지로 넘어가게 됩니다. 
아까 생성했던 아이디 비밀번호를 입력해주고 로그인을 누르면, 서비스를 이용할 수 있게 됩니다.

지금 보이는 화면이 우리팀이 개발한 Streamlit 대시보드의 메인 화면입니다.
해당 서비스가 지원하는 이미지 파일 형식은 JPG, PNG, JPEG로 구성되어있고, 
이 서비스에서 요구하는 이미지 요구사항을 기제해두어 사용자가 서비스를 이용하는데 차질이 없도록 하였습니다.

사이드바를 보면, 사용자의 이름이 나오고, 로그아웃할 수 있는 버튼이 있습니다.
그리고 CT 이미지를 업로드하는 박스가 있고, 우리팀이 개발한 모델들을 선택할 수가 있고, 가장 성능이 높았던
ResNet 50 fine-tuning 모델이 기본값으로 설정되어있습니다.

그 아래에는 고급 옵션으로 사용자가 직접 임계값을 설정해 뇌출혈 판단 정도를 설정할 수 있도록 개발하였습니다.

그 밑에는 사용 방법에 대한 문구를 기입해두었습니다.

그럼 이제 이미지를 첨부하여 테스트를 진행해보겠습니다.

캐글에 접속하여 모델 학습 시 사용했던 데이터셋이 아닌 다른 데이터셋을 검색해줍니다.(OOOOO)

그리고 정상인 뇌 CT 사진과 뇌출혈인 뇌 CT 사진을 하나씩 다운받아줍니다.

먼저 정상인 뇌 CT 사진을 첨부해보면 모델이 기존에 학습된 데이터를 기반으로 해당 뇌 CT 이미지가 어떤 상태인지
예측을 하고, 그 결과를 대시보드에 나타냅니다. 

녹색 계열을 사용하여 정상을 표시 했고, 뇌출혈 가능성과 정상 가능성의 확률이 표시되게 하였습니다.

그 아래에는 진단에 대한 소견과 참고 사항, 그리고 의료 면책 조항을 사용자가 확인 할 수 있도록 구현하였습니다.

다음으로 뇌출혈 CT 이미지를 첨부해 보겠습니다.

붉은 계열의 색을 사용하여 뇌출혈이 의심된다는 문구를 기입하였고, 정상일 때와 마찬가지로 뇌출혈과 정상 확률을 
확인할 수 있습니다. 

정상일 때와 다르게, 모델이 뇌출혈로 판단을 하면, Grad_CAM 분석 기능이 나오도록 하였습니다.

원본 이미지와, 히트맵 이미지, 그리고 이 두개를 겹친 오버레이 사진을 확인할 수 있습니다.

색이 붉은 부분일수록 모델이 집중적으로 확인을 했다는 표시이고, 이는 뇌의 어느 부분이 뇌출혈로 의심이 되는지
유추할 수 있습니다.

그 아래에는 정상과 동일하게 진단 설명과 의료 면책 조항을 확인할 수 있습니다.


------------------------------------------------------
이번 프로젝트에서 개발한 AI 모델은 뇌 CT 이미지를 분석하여 뇌출혈 여부를 약 88%의 정확도로 판별할 수 있었으며, 
이를 통해 응급실에서 환자가 병원에 도착한 직후 CT 스캔을 자동으로 판독하거나, 
원격 의료 환경에서 실시간으로 진단 결과를 제공할 수 있을 것으로 예측됩니다.
또한 개발한 모델은 의료진의 의사결정을 보조하여 판독 속도를 높이고, 
응급 치료 과정에서 시간을 단축하는 데 기여할 수 있었기에 응급 처치 시작 시점을 앞당길 수 있을 것으로 예상됩니다.

향후에는 모델 성능을 더욱 향상시키기 위해 데이터셋을 확장하고, 
다양한 CT/MRI 영상 포맷과 해상도를 이용하여 개선해 나갈 것입니다. 
그리고 뇌출혈 뿐만아니라, 뇌경색, 죄종양 등 뇌 CT 사진으로 판독할 수 있는 뇌 질환을 통합적으로 판독할 수 있는 모델로
버전을 업그레이드 할 예정에 있습니다.
또한 모델을 경량화하여 
모바일 기기에서도 사용 가능하도록 최적화할 예정이며, 
실제 병원 환경에서 임상 시험을 통해 적용 가능성을 검증할 것입니다. 
장기적으로는 AI 기반 뇌질환 조기 진단 시스템이 응급 의료 서비스의 표준 도구로 자리 잡아, 
환자의 생존율을 높이고 후유증을 최소화하는 데 기여하도록 하겠습니다.


이상으로 시연을 마치겠습니다.
